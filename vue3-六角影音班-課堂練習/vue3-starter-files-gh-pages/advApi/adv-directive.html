<!DOCTYPE html>
<html>

<head>
  <title>è‡ªè¨‚ç¾©æŒ‡ä»¤</title>
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1"
  >
  <link
    href="images/favicon.ico"
    rel="shortcut icon"
  >
  <meta charset="UTF-8">
  <script src="/javascripts/vendor.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.0.2/vue.global.js"></script>
</head>

<body class="bg-lighter">
  <div class="container main my-5">
    <div class="row">
      <main class="col post">
        <!-- ç« ç¯€æ¨™é¡Œ -->
        <div class="mb-4">
          <h1 class="mt-0 text-muted">è‡ªè¨‚ç¾©æŒ‡ä»¤</h1><small>æª”åï¼š<code>adv-directive.html</code></small>
        </div>
        <!-- ğŸ”¥ğŸ”¥ç·´ç¿’é–‹å§‹ğŸ”¥ğŸ”¥ -->


        <!-- æœ€å¾Œå®Œæˆæ™‚ï¼Œåœ¨è¼¸å…¥æ¡†è¼¸å…¥é©—è­‰ emailï¼Œconsole æœƒå‡ºç¾ Vue warn -->
        <!-- ä¸Šèª²ç« ç¯€æ¨“ä¸‹é¡Œæ–‡ç•™è¨€è€å¸«æœ‰å›ç­” -->
        <!-- é€™æ®µä¸»è¦æ˜¯å› ç‚ºå…¶ä¸­çš„ç‰‡æ®µç¨‹å¼ç¢¼ Object.keys... åˆ—èˆ‰åŠŸèƒ½ä»–æœƒå»ºè­°ä¸è¦å†æ­¤é¡å¯¦é«”ä¸Šé¿å…ä½¿ç”¨åˆ—èˆ‰ -->
        <!-- å¯¦æˆ°ä¸­å¯ä»¥ç”¨å„ç¨®æ›¿ä»£æ–¹å¼å–å¾—æ­¤å€¼ ä¾‹å¦‚ï¼š
- ç›´æ¥å¾æŒ‡ä»¤ä¸­å‚³å…¥å€¼
- å–å¾— input çš„ value å€¼(el.value)
é€™æ¨£å°±ä¸éœ€è¦ä½¿ç”¨åˆ°åˆ—èˆ‰
ä¹Ÿä¸æœƒå‡ºç¾ warn æç¤ºå›‰ -->

        <div id="app">
          <h2>è‡ªè¨‚ç¾©æŒ‡ä»¤</h2>
          <h3>ç”¨é€”</h3>
          <ul>
            <li>å¯¦æˆ°ä¸­å±¬æ–¼é€²éšåŠŸèƒ½ï¼Œåˆå­¸å¯å…ˆäº†è§£æœ‰æ­¤åŠŸèƒ½å³å¯</li>
            <li>å¯å¾å»¶ä¼¸å¥—ä»¶ä¸­çœ‹åˆ°ç›¸é—œçš„é‹ç”¨</li>
            <li>å¤šç”¨æ–¼ HTML ä¸Šçš„ä¾¿åˆ©æ“ä½œï¼Œè¤‡é›œåŠŸèƒ½é‚„æ˜¯æœƒæ­é…å…ƒä»¶</li>
          </ul>

          <h3>çµæ§‹</h3>
          <ul>
            <li>v-{è‡ªè¨‚ç¾©åç¨±}</li>
            <li>ä¸»è¦é€éç”Ÿå‘½é€±æœŸä¾†è§¸ç™¼è®Šå‹•ï¼Œå¯åƒè€ƒï¼š<a
                href="https://vue3js.cn/docs/zh/guide/custom-directive.html#%E5%8A%A8%E6%80%81%E6%8C%87%E4%BB%A4%E5%8F%82%E6%95%B0"
              >https://vue3js.cn/docs/zh/guide/custom-directive.html#%E5%8A%A8%E6%80%81%E6%8C%87%E4%BB%A4%E5%8F%82%E6%95%B0</a>
            </li>
          </ul>

          <!-- form-control æ˜¯ bootstrap æ›´æ”¹ è¼¸å…¥æ¡†çš„æ¨£å¼ -->
          <!-- v-validator æ”¾ form-control ä¸¦å‚³çµ¦è£¡é¢-->
          <!-- å¿…é ˆæ˜¯ä»¥ å­—ä¸² æ”¾åœ¨è£¡é¢ -->
          <input
            type="email"
            v-model="text"
            v-validator="'form-control'"
          >

        </div>
        <script type="module">
          const app = Vue.createApp({
            data() {
              return {
                text: '',
              }
            },
          });

          // è¨»å†ŠæŒ‡ä»¤
          app.directive('validator', {
            // directive ç”Ÿå‘½é€±æœŸï¼Œmounted å°±ä»£è¡¨ é€™å…ƒç´ ç”Ÿæˆæ™‚ å°±æœƒå•Ÿå‹•
            // el æŒ‡çš„æ˜¯ å…ƒä»¶æœ¬èº«
            // el.focus å…‰æ¨™æœƒè‡ªå‹•é–å®š
            mounted(el, binding) {
              el.focus();

              // å°‡å¤–éƒ¨çš„å€¼æ”¹ç‚º
              // å¤–éƒ¨çš„å€¼ åœ¨ input æ¨™ç±¤å…§ v-validator="'form-control'"
              // binding.valueï¼Œbinding æŒ‡çš„æ˜¯ å¤–é¢ v-validator ç¶å®šçš„
              // value å¯åœ¨ console -> object -> value -> form-control
              console.log(binding)
              el.className = binding.value
            },
            // å…ƒç´  è§¸ç™¼æ›´æ–°æ™‚ å•Ÿå‹•
            updated: function (el, binding, vnode) {
              // el å…ƒç´ æœ¬é«”
              // binding ç¶å®šçš„è³‡æºç‹€æ…‹
              // vnode è™›æ“¬ DOM ç¯€é»ï¼Œé€™é‚Šç¯€é» æŒ‡çš„æ˜¯ ç¶å®šçš„ input å…§ v-model="text"
              // æ„æ€æ˜¯ ç•¶è¼¸å…¥æ¡†å…§çš„ è³‡æ–™ æ­£åœ¨è¼¸å…¥ å°±ä»£è¡¨è§¸ç™¼æ›´æ–°
              console.log('update', el, binding, vnode);
              const className = binding.value;

              // å°‹æ‰¾ç•¶å‰çš„ model åç¨±ï¼ˆå–å¾— key å€¼ï¼Œä¸¦å¸¶å…¥ç¬¬ä¸€å€‹ï¼‰
              const currentModel = Object.keys(binding.instance)[0];

              // å¾ç•¶å‰ Model å–å€¼
              const value = binding.instance[currentModel];
              console.log(currentModel, value)

              // Email validate
              // Email é©—è­‰ï¼Œæ­£è¦è¡¨é”å¼
              const re = /^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;

              if (!re.test(value)) {
                el.className = `${className} is-invalid`
              } else {
                el.className = `${className} is-valid`
              }
            },
          })

          app.mount('#app');
        </script>

        <script>
// ESM ç‰ˆæœ¬çš„å·®ç•°ï¼ˆéœ€è¦ Webpackï¼‰
// import { Field, Form, ErrorMessage } from 'vee-validate';
//
// export default {
//   components: {
//     Field,
//     Form,
//     ErrorMessage,
//   },
//   methods: {
//     isRequired(value) {
//       if (value && value.trim()) {
//         return true;
//       }
//
//       return 'This is required';
//     },
//   },
// };
        </script>

        <!-- ğŸ™‡ğŸ™‡ç·´ç¿’çµæŸğŸ™‡ğŸ™‡ -->
      </main>

      <aside class="col-md-3">
        <div
          class="sticky-top"
          style="top: 76px"
        >
          <div class="list-group">

            <a
              href="/advApi/adv-refs.html"
              class="list-group-item list-group-item-action
        
        "
            >
              Refs
            </a>

            <a
              href="/advApi/adv-teleport.html"
              class="list-group-item list-group-item-action
        
        "
            >
              Teleport
            </a>

            <a
              href="/advApi/adv-provide.html"
              class="list-group-item list-group-item-action
        
        "
            >
              è·¨å±¤ç´šè³‡æ–™å‚³é Provide
            </a>

            <a
              href="/advApi/adv-component-v-model.html"
              class="list-group-item list-group-item-action
        
        "
            >
              è£½ä½œåŒ…å« v-model çš„å…ƒä»¶
            </a>

            <a
              href="/advApi/adv-mixins.html"
              class="list-group-item list-group-item-action
        
        "
            >
              Mixin æ··åˆ
            </a>

            <a
              href="/advApi/adv-extend.html"
              class="list-group-item list-group-item-action
        
        "
            >
              Extend æ“´å±•
            </a>

            <a
              href="/advApi/adv-directive.html"
              class="list-group-item list-group-item-action
        
        active"
            >
              è‡ªè¨‚ç¾©æŒ‡ä»¤
            </a>

            <a
              href="/advApi/adv-use-plugin.html"
              class="list-group-item list-group-item-action
        
        "
            >
              å¤–éƒ¨å¥—ä»¶å¼•ç”¨
            </a>

            <a
              href="/advApi/adv-vee-validation.html"
              class="list-group-item list-group-item-action
        
        "
            >
              è¡¨å–®é©—è­‰å¥—ä»¶
            </a>

          </div>
          <div class="mt-3 text-end p-2 bg-light rounded">
            <small class="text-black-50 fw-light mb-0">æ–‡ä»¶ç‰ˆæœ¬ï¼š2022/6/21</small>
          </div>
        </div>

      </aside>

    </div>
  </div>

  <nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-secondary">
    <div class="container-fluid">
      <a
        class="navbar-brand"
        href="/"
      >Vue 3 ç·´ç¿’æ‰‹å†Š</a>
      <div
        class="collapse navbar-collapse"
        id="navbarCollapse"
      >
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a
              class="nav-link "
              href="/es6/shorthand.html"
            >JS å¿…å‚™è§€å¿µ</a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link "
              href="/intro/createApp.html"
            >èªè­˜ Vue.js</a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link "
              href="/template/v-text.html"
            >æ¨¡æ¿</a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link "
              href="/optionsApi/options-methods.html"
            >æ–¹æ³•</a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link "
              href="/components/component_register.html"
            >å…ƒä»¶</a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link active"
              href="/advApi/adv-refs.html"
            >é€²éš</a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link "
              href="/router/vue-router.html"
            >è·¯ç”±</a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link "
              href="/composition/proxy.html"
            >Composition API</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <footer class="footer py-2 bg-light">
    <div class="container text-center">
      <small class="text-black-50 fw-light mb-0">å…­è§’å­¸é™¢ Vue èª²ç¨‹å°ˆå±¬æ–‡ä»¶</small>
    </div>
  </footer>
  <link
    rel="stylesheet"
    href="/stylesheets/all.css"
  >
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
  >
</body>

</html>